# Cookie Sniffer 扩展

一个强大的 Chrome 扩展，用于自动捕获指定请求的 Cookie。

## 功能特性

### 🆕 新功能 (v2.1)
- **规则编辑功能**: 支持修改已添加的匹配规则
- **正则表达式转义辅助**: 提供特殊字符转义工具和测试功能
- **界面优化**: 修复多滚动条问题，改善用户体验
- **一键打开页面**: 为每个匹配规则设置对应的页面 URL

### 🆕 新功能 (v2.0)
- **正则表达式支持**: 支持使用正则表达式匹配 URL
- **多种匹配模式**: 
  - 关键词匹配: URL 包含指定关键词
  - 全匹配: URL 完全匹配指定值
  - 正则匹配: 使用正则表达式匹配 URL
- **智能 Cookie 获取**: 优先通过 URL 获取 Cookie，提高准确性
- **详细的匹配信息**: 显示每个 Cookie 的匹配规则和来源

### 核心功能
- 自动监听网络请求
- 根据自定义规则捕获 Cookie
- 实时显示最新捕获的 Cookie
- 保存历史记录
- 一键复制 Cookie
- 支持多种匹配模式

## 使用方法

### 1. 添加匹配规则
在扩展弹窗中，你可以添加自定义匹配规则：

- **规则名称**: 给规则起一个便于识别的名称
- **匹配值**: 要匹配的 URL 内容
- **匹配类型**: 
  - 关键词: URL 包含指定关键词
  - 全匹配: URL 完全匹配指定值  
  - 正则: 使用正则表达式匹配
- **页面 URL**: 可选，用于一键打开相关页面

### 2. 编辑匹配规则
- 点击规则右侧的 ✏️ 按钮进入编辑模式
- 修改规则名称、匹配值、类型或页面URL
- 点击"保存"按钮确认修改，或点击"取消"放弃修改

### 3. 正则表达式使用
- 使用 `regex-helper.html` 工具进行特殊字符转义
- 在添加正则规则前先测试匹配效果
- 注意转义特殊字符：`. * + ? ^ $ { } ( ) [ ] | \`

### 4. 示例规则

```
规则名称: baidu
匹配值: https://baidu.com
匹配类型: 全匹配
页面 URL: https://baidu.com

规则名称: api-requests
匹配值: /api/
匹配类型: 关键词
页面 URL: 

规则名称: login-pages
匹配值: /login|/signin|/auth
匹配类型: 正则
页面 URL: 

规则名称: bilibili-data
匹配值: https://data\.bilibili\.com/.*
匹配类型: 正则
页面 URL: https://data.bilibili.com
```

### 5. 查看结果
- 最新捕获的 Cookie 会显示在顶部，包含来源信息
- 历史记录显示所有捕获的 Cookie，包含匹配规则信息
- 点击历史记录中的 URL 可以查看完整地址
- 点击"打开页面"链接可以直接访问相关页面

## 安装方法

1. 下载所有文件到本地目录
2. 打开 Chrome 浏览器，进入扩展管理页面 (`chrome://extensions/`)
3. 开启"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择包含扩展文件的目录

## 文件结构

```
cookie-sniffer/
├── manifest.json          # 扩展配置文件
├── background.js          # 后台脚本，处理网络请求和 Cookie 获取
├── popup.html             # 扩展弹窗界面
├── popup.js               # 弹窗交互逻辑
├── content.js             # 内容脚本
├── styles.css             # 样式文件
├── test.html              # 完整测试页面
├── quick-test.html        # 快速测试页面
├── regex-helper.html      # 正则表达式辅助工具
├── regex-examples.md      # 正则表达式示例文档
└── README.md              # 说明文档
```

## 正则表达式辅助工具

### 使用 regex-helper.html
1. 打开 `regex-helper.html` 页面
2. 在"特殊字符转义"部分输入包含特殊字符的文本
3. 点击"转义特殊字符"按钮获得转义后的正则表达式
4. 在"正则表达式测试"部分测试匹配效果
5. 参考"常用正则表达式示例"学习常用模式

### 常用特殊字符转义
- `.` → `\.` (点号)
- `*` → `\*` (星号)
- `+` → `\+` (加号)
- `?` → `\?` (问号)
- `^` → `\^` (脱字符)
- `$` → `\$` (美元符)
- `{` → `\{` (左大括号)
- `}` → `\}` (右大括号)
- `(` → `\(` (左小括号)
- `)` → `\)` (右小括号)
- `[` → `\[` (左方括号)
- `]` → `\]` (右方括号)
- `|` → `\|` (竖线)
- `\` → `\\` (反斜杠)

## 技术特性

- **Manifest V3**: 使用最新的 Chrome 扩展 API
- **Service Worker**: 后台脚本使用 Service Worker
- **实时监听**: 使用 `chrome.webRequest` API 监听网络请求
- **智能存储**: 使用 `chrome.storage` API 持久化数据
- **响应式设计**: 现代化的用户界面

## 更新日志

### v2.1
- ✅ 添加规则编辑功能
- ✅ 提供正则表达式转义辅助工具
- ✅ 修复多滚动条问题
- ✅ 优化界面布局和用户体验
- ✅ 改进错误处理和用户提示

### v2.0
- ✅ 支持正则表达式匹配
- ✅ 新增全匹配模式
- ✅ 优化 Cookie 获取逻辑（优先 URL 获取）
- ✅ 显示匹配规则信息
- ✅ 支持一键打开页面
- ✅ 改进用户界面

### v1.0
- ✅ 基础 Cookie 捕获功能
- ✅ 关键词匹配
- ✅ 历史记录
- ✅ 复制功能

## 注意事项

- 扩展需要访问所有网站的权限来监听网络请求
- 正则表达式需要符合 JavaScript 正则语法
- Cookie 获取遵循浏览器的安全策略
- 历史记录最多保存 10 条
- 建议使用正则表达式辅助工具进行测试

## 故障排除

### 正则表达式不生效？
1. 检查正则表达式语法是否正确
2. 确保特殊字符已正确转义
3. 使用 `regex-helper.html` 工具进行测试
4. 查看浏览器控制台的错误信息

### 界面显示问题？
1. 确保扩展已正确安装
2. 检查浏览器版本是否支持 Manifest V3
3. 尝试重新加载扩展

### 规则编辑失败？
1. 检查规则名称是否与其他规则冲突
2. 确保所有必填字段都已填写
3. 验证正则表达式语法

## 许可证

MIT License 