<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>å¯¼å…¥åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
    </style>
</head>
<body>
    <h1>ğŸª Cookie Sniffer å¯¼å…¥åŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="test-section">
        <h3>æµ‹è¯•JSONæ•°æ®</h3>
        <p>ä½¿ç”¨ä»¥ä¸‹JSONæ•°æ®æµ‹è¯•å¯¼å…¥åŠŸèƒ½ï¼š</p>
        <div class="result" id="testJson">
{
  "version": "1.0",
  "exportTime": "2024-01-01T12:00:00.000Z",
  "rules": [
    {
      "key": "test-api",
      "value": "/api/",
      "type": "å…³é”®è¯",
      "url": "https://example.com/api/"
    },
    {
      "key": "test-login",
      "value": "login",
      "type": "å…³é”®è¯",
      "url": "https://example.com/login"
    }
  ]
}
        </div>
        <button class="test-button" onclick="copyTestJson()">å¤åˆ¶æµ‹è¯•JSON</button>
    </div>

    <div class="test-section">
        <h3>æµ‹è¯•æ­¥éª¤</h3>
        <ol>
            <li>æ‰“å¼€Cookie Snifferæ‰©å±•</li>
            <li>ç‚¹å‡»è®¾ç½®æŒ‰é’®(âš™ï¸)</li>
            <li>ç‚¹å‡»"å¯¼å…¥è§„åˆ™"æŒ‰é’®</li>
            <li>é€‰æ‹©æ–‡ä»¶æˆ–ç²˜è´´JSONå†…å®¹</li>
            <li>ç‚¹å‡»"ç¡®è®¤å¯¼å…¥"æŒ‰é’®</li>
            <li>æ£€æŸ¥æ§åˆ¶å°è¾“å‡º</li>
        </ol>
    </div>

    <div class="test-section">
        <h3>æ•…éšœæ’é™¤</h3>
        <ul>
            <li>ç¡®ä¿æ‰©å±•å·²æ­£ç¡®å®‰è£…</li>
            <li>æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯</li>
            <li>ç¡®è®¤JSONæ ¼å¼æ­£ç¡®</li>
            <li>æ£€æŸ¥æŒ‰é’®æ˜¯å¦å¯ä»¥è¢«ç‚¹å‡»</li>
            <li>æŸ¥çœ‹background scriptçš„æ—¥å¿—è¾“å‡º</li>
            <li>æ£€æŸ¥æ¶ˆæ¯ç«¯å£æ˜¯å¦æ­£å¸¸è¿æ¥</li>
        </ul>
    </div>

    <div class="test-section">
        <h3>è°ƒè¯•ä¿¡æ¯</h3>
        <div id="debugInfo" class="result"></div>
        <button class="test-button" onclick="checkExtension()">æ£€æŸ¥æ‰©å±•çŠ¶æ€</button>
        <button class="test-button" onclick="testImport()">æµ‹è¯•å¯¼å…¥åŠŸèƒ½</button>
        <button class="test-button" onclick="clearDebug()">æ¸…ç©ºè°ƒè¯•ä¿¡æ¯</button>
    </div>

    <script>
        function copyTestJson() {
            const testJson = document.getElementById('testJson').textContent;
            navigator.clipboard.writeText(testJson).then(() => {
                alert('æµ‹è¯•JSONå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            }).catch(() => {
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
            });
        }

        function checkExtension() {
            const debugInfo = document.getElementById('debugInfo');
            debugInfo.textContent = 'æ£€æŸ¥æ‰©å±•çŠ¶æ€...\n';
            
            // æ£€æŸ¥æ‰©å±•æ˜¯å¦å®‰è£…
            if (typeof chrome !== 'undefined' && chrome.runtime) {
                debugInfo.textContent += 'âœ… Chromeæ‰©å±•APIå¯ç”¨\n';
                
                // å°è¯•å‘é€æ¶ˆæ¯åˆ°æ‰©å±•
                try {
                    chrome.runtime.sendMessage({ type: "getMatchRules" }, function(response) {
                        if (chrome.runtime.lastError) {
                            debugInfo.textContent += `âŒ æ‰©å±•é€šä¿¡é”™è¯¯: ${chrome.runtime.lastError.message}\n`;
                        } else if (response) {
                            debugInfo.textContent += `âœ… æ‰©å±•å“åº”æ­£å¸¸ï¼Œå½“å‰è§„åˆ™æ•°é‡: ${response.rules ? response.rules.length : 0}\n`;
                        } else {
                            debugInfo.textContent += 'âŒ æ‰©å±•æ²¡æœ‰å“åº”\n';
                        }
                    });
                } catch (error) {
                    debugInfo.textContent += `âŒ å‘é€æ¶ˆæ¯å¤±è´¥: ${error.message}\n`;
                }
            } else {
                debugInfo.textContent += 'âŒ Chromeæ‰©å±•APIä¸å¯ç”¨\n';
            }
        }

        function testImport() {
            const debugInfo = document.getElementById('debugInfo');
            const testData = {
                version: "1.0",
                exportTime: new Date().toISOString(),
                rules: [
                    {
                        key: "test-import",
                        value: "/test/",
                        type: "å…³é”®è¯",
                        url: "https://test.example.com"
                    }
                ]
            };

            debugInfo.textContent += '\nå¼€å§‹æµ‹è¯•å¯¼å…¥åŠŸèƒ½...\n';
            debugInfo.textContent += `æµ‹è¯•æ•°æ®: ${JSON.stringify(testData, null, 2)}\n`;

            // è®¾ç½®è¶…æ—¶
            const timeout = setTimeout(() => {
                debugInfo.textContent += 'âŒ æµ‹è¯•å¯¼å…¥è¶…æ—¶\n';
            }, 10000);

            chrome.runtime.sendMessage({ 
                type: "importRules", 
                rules: testData.rules 
            }, function(response) {
                clearTimeout(timeout);
                
                if (chrome.runtime.lastError) {
                    debugInfo.textContent += `âŒ å¯¼å…¥æµ‹è¯•å¤±è´¥: ${chrome.runtime.lastError.message}\n`;
                } else if (response) {
                    debugInfo.textContent += `âœ… å¯¼å…¥æµ‹è¯•æˆåŠŸ: ${JSON.stringify(response)}\n`;
                } else {
                    debugInfo.textContent += 'âŒ å¯¼å…¥æµ‹è¯•æ²¡æœ‰å“åº”\n';
                }
            });
        }

        function clearDebug() {
            document.getElementById('debugInfo').textContent = '';
        }
    </script>
</body>
</html>
